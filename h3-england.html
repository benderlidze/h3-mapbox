<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Add a default marker to a web map</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/h3-js"></script>
    <script src="https://unpkg.com/deck.gl@^8.0.0/dist.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <script>

        const eng1 = {
            "type": "FeatureCollection",
            "name": "eng",
            "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
            "features": [
                { "type": "Feature", "properties": { "featurecla": "Admin-0 country", "scalerank": 1, "labelrank": 2, "sovereignt": "United Kingdom", "sov_a3": "GB1", "adm0_dif": 1, "level": 2, "type": "Country", "tlc": "1", "admin": "United Kingdom", "adm0_a3": "GBR", "geou_dif": 0, "geounit": "United Kingdom", "gu_a3": "GBR", "su_dif": 0, "subunit": "United Kingdom", "su_a3": "GBR", "brk_diff": 0, "name": "United Kingdom", "name_long": "United Kingdom", "brk_a3": "GBR", "brk_name": "United Kingdom", "brk_group": null, "abbrev": "U.K.", "postal": "GB", "formal_en": "United Kingdom of Great Britain and Northern Ireland", "formal_fr": null, "name_ciawf": "United Kingdom", "note_adm0": null, "note_brk": null, "name_sort": "United Kingdom", "name_alt": null, "mapcolor7": 6, "mapcolor8": 6, "mapcolor9": 6, "mapcolor13": 3, "pop_est": 66834405, "pop_rank": 16, "pop_year": 2019, "gdp_md": 2829108, "gdp_year": 2019, "economy": "1. Developed region: G7", "income_grp": "1. High income: OECD", "fips_10": "UK", "iso_a2": "GB", "iso_a2_eh": "GB", "iso_a3": "GBR", "iso_a3_eh": "GBR", "iso_n3": "826", "iso_n3_eh": "826", "un_a3": "826", "wb_a2": "GB", "wb_a3": "GBR", "woe_id": -90, "woe_id_eh": 23424975, "woe_note": "Eh ID includes Channel Islands and Isle of Man. UK constituent countries of England (24554868), Wales (12578049), Scotland (12578048), and Northern Ireland (20070563).", "adm0_iso": "GBR", "adm0_diff": null, "adm0_tlc": "GBR", "adm0_a3_us": "GBR", "adm0_a3_fr": "GBR", "adm0_a3_ru": "GBR", "adm0_a3_es": "GBR", "adm0_a3_cn": "GBR", "adm0_a3_tw": "GBR", "adm0_a3_in": "GBR", "adm0_a3_np": "GBR", "adm0_a3_pk": "GBR", "adm0_a3_de": "GBR", "adm0_a3_gb": "GBR", "adm0_a3_br": "GBR", "adm0_a3_il": "GBR", "adm0_a3_ps": "GBR", "adm0_a3_sa": "GBR", "adm0_a3_eg": "GBR", "adm0_a3_ma": "GBR", "adm0_a3_pt": "GBR", "adm0_a3_ar": "GBR", "adm0_a3_jp": "GBR", "adm0_a3_ko": "GBR", "adm0_a3_vn": "GBR", "adm0_a3_tr": "GBR", "adm0_a3_id": "GBR", "adm0_a3_pl": "GBR", "adm0_a3_gr": "GBR", "adm0_a3_it": "GBR", "adm0_a3_nl": "GBR", "adm0_a3_se": "GBR", "adm0_a3_bd": "GBR", "adm0_a3_ua": "GBR", "adm0_a3_un": -99, "adm0_a3_wb": -99, "continent": "Europe", "region_un": "Europe", "subregion": "Northern Europe", "region_wb": "Europe & Central Asia", "name_len": 14, "long_len": 14, "abbrev_len": 4, "tiny": -99, "homepart": 1, "min_zoom": 0, "min_label": 1.7, "max_label": 6.7, "label_x": -2.116346, "label_y": 54.402739, "ne_id": 1159320713, "wikidataid": "Q145", "name_ar": "المملكة المتحدة", "name_bn": "যুক্তরাজ্য", "name_de": "Vereinigtes Königreich", "name_en": "United Kingdom", "name_es": "Reino Unido", "name_fa": "بریتانیا", "name_fr": "Royaume-Uni", "name_el": "Ηνωμένο Βασίλειο", "name_he": "הממלכה המאוחדת", "name_hi": "यूनाइटेड किंगडम", "name_hu": "Egyesült Királyság", "name_id": "Britania Raya", "name_it": "Regno Unito", "name_ja": "イギリス", "name_ko": "영국", "name_nl": "Verenigd Koninkrijk", "name_pl": "Wielka Brytania", "name_pt": "Reino Unido", "name_ru": "Великобритания", "name_sv": "Storbritannien", "name_tr": "Birleşik Krallık", "name_uk": "Велика Британія", "name_ur": "مملکت متحدہ", "name_vi": "Vương quốc Liên hiệp Anh và Bắc Ireland", "name_zh": "英国", "name_zht": "英國", "fclass_iso": "Admin-0 country", "tlc_diff": null, "fclass_tlc": "Admin-0 country", "fclass_us": null, "fclass_fr": null, "fclass_ru": null, "fclass_es": null, "fclass_cn": null, "fclass_tw": null, "fclass_in": null, "fclass_np": null, "fclass_pk": null, "fclass_de": null, "fclass_gb": null, "fclass_br": null, "fclass_il": null, "fclass_ps": null, "fclass_sa": null, "fclass_eg": null, "fclass_ma": null, "fclass_pt": null, "fclass_ar": null, "fclass_jp": null, "fclass_ko": null, "fclass_vn": null, "fclass_tr": null, "fclass_id": null, "fclass_pl": null, "fclass_gr": null, "fclass_it": null, "fclass_nl": null, "fclass_se": null, "fclass_bd": null, "fclass_ua": null, "filename": "GBR.geojson" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[-2.667675781249983, 51.622998046874997], [-2.590283203124983, 51.60859375], [-2.88125, 51.405664062499994], [-3.042041015624989, 51.248583984374996], [-3.135986328125, 51.205029296874997], [-3.375097656249977, 51.196972656249997], [-3.60791015625, 51.228564453124996], [-3.842333984374989, 51.230908203124997], [-4.188183593749983, 51.188525390624996], [-4.296484374999977, 51.027148437499996], [-4.523095703124994, 50.977441406249994], [-4.582910156249994, 50.7763671875], [-4.956396484374977, 50.523144531249997], [-5.141796874999983, 50.373730468749997], [-5.34228515625, 50.246142578124996], [-5.570654296874977, 50.196972656249997], [-5.65625, 50.131884765624996], [-5.622119140624989, 50.050683593749994], [-5.433984375, 50.104443359374997], [-5.322851562499977, 50.082958984374997], [-5.225244140624994, 50.021386718749994], [-5.118505859374977, 50.038330078125], [-5.048632812499989, 50.134375], [-4.727978515624983, 50.290478515624997], [-4.506689453124977, 50.341357421874996], [-4.296972656249977, 50.359082031249997], [-4.172558593749983, 50.390820312499997], [-4.103417968749994, 50.348535156249994], [-3.900195312499989, 50.2859375], [-3.793359375, 50.229248046875], [-3.679785156249977, 50.239941406249997], [-3.584375, 50.321826171874996], [-3.485449218749977, 50.547949218749999], [-3.404589843749989, 50.632421875], [-2.999414062499994, 50.716601562499996], [-2.776953124999977, 50.70556640625], [-2.547753906249994, 50.616308593749999], [-2.433447265624977, 50.59921875], [-2.350146484374989, 50.637402343749997], [-2.035839843749983, 50.603076171874996], [-1.962060546874994, 50.627783203124999], [-2.031054687499989, 50.725390625], [-1.866015624999989, 50.715234375], [-1.516748046874994, 50.747460937499994], [-1.285058593749994, 50.857324218749994], [-1.132861328124989, 50.844580078124999], [-0.871386718749989, 50.772802734374999], [-0.785253906249977, 50.765429687499996], [-0.450781249999977, 50.81015625], [-0.203906249999989, 50.814355468749994], [0.205078125, 50.763037109374999], [0.299707031250023, 50.775976562499999], [0.532324218750006, 50.853417968749994], [0.684375, 50.885546875], [0.772363281250023, 50.933984375], [0.960156250000011, 50.925878906249999], [1.04443359375, 51.047265625], [1.365527343750017, 51.15546875], [1.397558593750006, 51.18203125], [1.414941406250023, 51.36328125], [1.257128906250017, 51.375097656249999], [0.950239651759837, 51.370531516575234], [0.890210628288727, 51.419099698246555], [0.758278708572002, 51.441719794299267], [0.593457031250011, 51.519482421874997], [0.799218750000023, 51.537890625], [0.890917968750017, 51.571435546874994], [0.898046875, 51.689404296874997], [0.752246093750017, 51.729589843749999], [0.955078125, 51.8078125], [1.101171875, 51.785449218749996], [1.2744140625, 51.845361328125001], [1.316796875000023, 51.956933593750001], [1.558984375000023, 52.086865234374997], [1.74658203125, 52.468994140625], [1.716113281250017, 52.67724609375], [1.65673828125, 52.753710937499996], [1.382128906250017, 52.893505859374997], [1.055566406250023, 52.958984375], [0.704492187500023, 52.977246093749997], [0.558789062500011, 52.966943359375001], [0.381933593750006, 52.8251953125], [0.27978515625, 52.808691406249999], [0.0458984375, 52.905615234374999], [0.298046875000011, 53.081103515624996], [0.355761718750017, 53.159960937499996], [0.27099609375, 53.335498046874996], [0.128320312500023, 53.46826171875], [-0.293701171875, 53.692333984374997], [-0.27001953125, 53.736767578124997], [-0.07373046875, 53.643652343749999], [0.036083984375011, 53.640527343750001], [0.010546875000017, 53.742822265625001], [-0.16875, 53.941650390625], [-0.20556640625, 54.021728515625], [-0.084375, 54.118066406250001], [-0.370361328125, 54.279199218750001], [-0.67138671875, 54.50390625], [-0.759326171874989, 54.54140625], [-1.154394531249977, 54.654492187499997], [-1.291748046875, 54.773876953124997], [-1.422656249999989, 55.026416015624996], [-1.610156249999989, 55.498095703124996], [-1.655371093749977, 55.570361328124996], [-1.830273437499983, 55.671728515624999], [-2.147070312499977, 55.902978515625001], [-2.599316406249983, 56.027294921874997], [-2.836865234374983, 56.026269531250001], [-3.048730468749994, 55.951953125], [-3.362255859374983, 56.027636718749996], [-3.17822265625, 56.080126953124996], [-2.979785156249989, 56.194091796875], [-2.767578125, 56.2021484375], [-2.652734375, 56.318261718750001], [-3.047412109374989, 56.449365234375001], [-2.775195312499989, 56.482958984374996], [-2.592675781249994, 56.561572265624996], [-2.426660156249994, 56.730712890625], [-2.26025390625, 56.863330078124996], [-2.089550781249983, 57.1025390625], [-2.020312499999989, 57.258886718749999], [-1.777929687499977, 57.49375], [-1.867382812499983, 57.612353515624996], [-2.074072265624977, 57.702392578125], [-2.244140625, 57.680859375], [-2.856298828124977, 57.692285156250001], [-3.083935546874983, 57.673486328125001], [-3.402783203124983, 57.708251953125], [-3.8681640625, 57.600341796875], [-4.134521484375, 57.577734375], [-4.078417968749989, 57.677050781249996], [-3.887939453125, 57.786914062499996], [-4.035595703124983, 57.852001953124997], [-3.990039062499989, 57.959033203124996], [-3.775, 58.052099609374999], [-3.410986328124977, 58.239648437499994], [-3.212353515624983, 58.321240234374997], [-3.101123046874989, 58.433691406249999], [-3.109667968749989, 58.515478515624999], [-3.053076171874977, 58.634814453125003], [-3.259130859374977, 58.65], [-3.453564453124983, 58.616894531249997], [-3.859521484374994, 58.577099609374997], [-4.188623046874994, 58.557226562499999], [-4.433251953124994, 58.512841796874994], [-4.491894531249983, 58.568457031249999], [-4.715429687499977, 58.510009765625], [-4.809619140624989, 58.572900390624994], [-4.924658203124977, 58.58837890625], [-5.066503906249977, 58.520214843749997], [-5.090136718749989, 58.384521484375], [-5.00830078125, 58.262646484374997], [-5.33828125, 58.238720703124997], [-5.39375, 58.043603515624994], [-5.176904296874994, 57.906396484375001], [-5.349023437499994, 57.878076171875001], [-5.653942419460143, 57.923424680091607], [-5.836008468669225, 57.684420187406815], [-5.867672129401239, 57.496328444536964], [-5.794921875, 57.378808593750001], [-5.656347656249977, 57.334082031249999], [-5.561914062499994, 57.232714843749996], [-5.59130859375, 57.10234375], [-5.736279296874983, 56.960644531249997], [-5.861425781249977, 56.902685546874999], [-5.730615234374994, 56.853076171874996], [-5.877636718749983, 56.779638671874999], [-6.034716796874989, 56.763916015625], [-5.936767578125, 56.605712890625], [-5.864843749999977, 56.561865234374999], [-5.652441406249977, 56.531982421875], [-5.564208984375, 56.565722656249996], [-5.391943359374977, 56.514794921875001], [-5.534960937499989, 56.250830078124999], [-5.609570312499983, 56.055273437499999], [-5.622851562499989, 55.813134765625001], [-5.573876953124994, 55.791699218749997], [-5.681347656249983, 55.623974609374997], [-5.768212890624994, 55.362646484374999], [-5.646533203124989, 55.326855468749997], [-5.556445312499989, 55.389599609374997], [-5.385839843749977, 55.770117187499999], [-4.891845703125, 55.699121093750001], [-4.724169921874989, 55.598291015625001], [-4.6767578125, 55.501318359374999], [-4.721142578124983, 55.420996093749999], [-4.965185546874977, 55.149462890624996], [-5.055859374999983, 54.988134765624999], [-5.172705078124977, 54.985888671874996], [-5.135498046875, 54.857519531249999], [-5.032324218749977, 54.761376953125001], [-4.889501953124977, 54.772265625], [-4.818066406249983, 54.846142578124997], [-4.517480468749994, 54.758349609374996], [-4.303662109374983, 54.835693359375], [-4.208398437499994, 54.837158203125], [-4.132958984374994, 54.779248046874997], [-3.957910156249994, 54.780957031249997], [-3.783251953124989, 54.869921875], [-3.550439453124994, 54.947412109375001], [-3.43408203125, 54.963769531250001], [-3.267919921874977, 54.906591796874999], [-3.464599609375, 54.773095703125001], [-3.592041015625, 54.564355468750001], [-3.569384765624989, 54.467578125], [-3.321533203125, 54.229101562499999], [-3.165966796874983, 54.1279296875], [-2.993505859374977, 54.170507812499999], [-2.846484374999989, 54.135302734374996], [-2.899853515624983, 53.960693359375], [-3.026757812499994, 53.905908203125001], [-3.031787109374989, 53.773583984375001], [-2.925097656249989, 53.732763671874999], [-3.059472656249994, 53.586230468749996], [-3.064746093749989, 53.426855468749999], [-3.165576171874989, 53.394677734375001], [-3.097558593749994, 53.260302734374996], [-3.326171875, 53.34716796875], [-3.645898437499994, 53.297900390624996], [-3.809277343749983, 53.302685546874997], [-4.111035156249983, 53.218945312499997], [-4.328417968749989, 53.105126953125001], [-4.405078124999989, 53.013818359375001], [-4.638330078124994, 52.89111328125], [-4.583691406249983, 52.81494140625], [-4.3564453125, 52.897412109374997], [-4.101464843749994, 52.915478515624997], [-4.117529296874977, 52.820019531249997], [-4.039257812499983, 52.704052734374997], [-4.078906249999989, 52.607861328124997], [-3.980322265624977, 52.541748046875], [-4.149365234374983, 52.326269531249999], [-4.383154296874977, 52.197314453124996], [-4.561132812499977, 52.15087890625], [-4.878515624999977, 52.041845703124999], [-5.088085937499983, 51.995898437499996], [-5.262304687499977, 51.880175781249996], [-5.200585937499994, 51.861376953124996], [-5.124755859375, 51.705859375], [-4.902294921874983, 51.626269531249996], [-4.600781249999983, 51.737646484374999], [-4.386279296874989, 51.741064453124999], [-4.173681640624977, 51.62734375], [-4.115283203124989, 51.56640625], [-3.943652343749989, 51.597509765624999], [-3.7626953125, 51.539941406249994], [-3.562353515624977, 51.413818359375], [-3.293115234374994, 51.390429687499996], [-2.978515625, 51.538867187499996], [-2.742138671874983, 51.581103515624996], [-2.667675781249983, 51.622998046874997]]], [[[-4.19677734375, 53.321435546875001], [-4.315087890624994, 53.417236328125], [-4.461718749999989, 53.419287109374999], [-4.581665741962452, 53.406774040932866], [-4.703043108101838, 53.30007169802424], [-4.471972656249989, 53.176367187499999], [-4.373046875, 53.134179687500001], [-4.084277343749989, 53.264306640625001], [-4.19677734375, 53.321435546875001]]], [[[-0.883284202503368, 60.845392908179761], [-1.414208984374994, 60.598730468749999], [-1.548828125, 60.481298828124999], [-1.449560546874977, 60.468554687500003], [-1.47697784122863, 60.368831115263141], [-1.743480319056415, 60.341423378655229], [-1.548221077875662, 60.146296419721956], [-1.322802734374989, 60.188378906249994], [-1.376709582243919, 60.067393126787863], [-1.376709582243919, 59.890492320564938], [-1.271164046470539, 59.858708707192157], [-1.070627528501117, 60.141042079358677], [-0.991468376671082, 60.510720614216609], [-0.76718411315265, 60.602811216964341], [-0.883284202503368, 60.845392908179761]]], [[[-2.403139917640041, 59.308334524775077], [-2.896565297380592, 59.386359726819222], [-3.156494140625, 59.136328125], [-3.310351562499989, 59.130810546874997], [-3.474427105739847, 58.839091694059746], [-2.973085810816292, 58.701026084661436], [-2.706583332988508, 58.926408780911622], [-2.403139917640041, 59.308334524775077]]], [[[-5.105419921874983, 55.448828125], [-5.10498046875, 55.573974609375], [-5.160400390625, 55.666796875], [-5.318115234375, 55.709179687499997], [-5.392675781249977, 55.618359375], [-5.331494140624983, 55.481054687499999], [-5.105419921874983, 55.448828125]]], [[[-5.777880859374989, 56.344335937499999], [-5.653942419460135, 56.430474123758216], [-5.946679687499994, 56.534521484374999], [-6.102734374999983, 56.645654296875001], [-6.286328124999983, 56.611865234374996], [-6.310644531249977, 56.552148437500001], [-6.138867187499983, 56.490625], [-6.427063469000144, 56.323815605291443], [-6.332072486804102, 56.266711222306405], [-5.777880859374989, 56.344335937499999]]], [[[-5.716280251526289, 56.148571909868068], [-6.156932863380151, 55.923029166224815], [-6.350872785363736, 55.891229557088451], [-6.445263671874983, 55.832373046874999], [-6.515787685009642, 55.676085436335022], [-6.418158064419266, 55.69542272002721], [-6.338998912589231, 55.748179684401748], [-6.384845254690792, 55.589694851168076], [-6.200140567087376, 55.58149275070906], [-6.010158602695293, 55.667901399078893], [-5.973547494973903, 55.789740551548469], [-5.684616590794275, 56.112544188200054], [-5.716280251526289, 56.148571909868068]]], [[[-6.198681640624983, 58.36328125], [-6.237451171874994, 58.502832031249994], [-6.787744140624994, 58.283886718749997], [-6.724707031249977, 58.197558593750003], [-6.88623046875, 58.182568359374997], [-7.012060546874977, 58.228710937499997], [-7.085253906249989, 58.182177734375003], [-7.057080078124983, 58.003173828125], [-6.864160156249994, 57.932861328125], [-7.559039340169653, 57.592617165737849], [-7.386868184939322, 57.510418746089847], [-7.429746058847263, 57.141565403797486], [-7.632261555612433, 56.789511310169104], [-7.273406733982942, 57.055926405213683], [-7.181054390181232, 57.466895536224726], [-6.683300781249983, 57.911035156250001], [-6.425195312499994, 58.021289062500003], [-6.4365234375, 58.091894531249999], [-6.325830078124994, 58.188867187499994], [-6.198681640624983, 58.36328125]]], [[[-6.144726562499983, 57.504980468749999], [-6.166064453124989, 57.585302734374999], [-6.300408826072095, 57.706982265870131], [-6.416508915422813, 57.650550716325633], [-6.616796874999977, 57.562695312499997], [-6.761132812499994, 57.4423828125], [-6.675439453124994, 57.362890625], [-6.48511351367551, 57.294433391030367], [-6.310963379649434, 57.150154207194525], [-6.162744140624994, 57.18212890625], [-6.034375, 57.201220703124996], [-6.014746093749977, 57.051953125], [-5.949072265624977, 57.045166015625], [-5.668652343749983, 57.226904296874999], [-5.706005859374983, 57.268945312500001], [-5.880273437499994, 57.263232421874996], [-6.135546874999989, 57.314257812499996], [-6.144726562499983, 57.504980468749999]]], [[[-6.218017578125, 54.088720703124999], [-6.01904296875, 54.05126953125], [-5.937744140625, 54.0890625], [-5.826171875, 54.23583984375], [-5.606787109374977, 54.272558593749999], [-5.557812499999983, 54.370996093750001], [-5.655957031249983, 54.381738281250001], [-5.646093749999977, 54.477880859374999], [-5.470410156249983, 54.500195312499997], [-5.58251953125, 54.663427734374999], [-5.879101562499983, 54.684375], [-5.710742187499989, 54.757080078125], [-5.716845703124989, 54.817480468749999], [-5.869189453124989, 54.916210937499997], [-5.985742187499994, 55.0296875], [-6.035791015624994, 55.14453125], [-6.129150390625, 55.217382812499999], [-6.475048828124983, 55.241015625], [-6.698828124999977, 55.193457031249999], [-6.947167968749994, 55.182519531250001], [-7.100634765624989, 55.048291015624997], [-7.218652343749994, 55.091992187499997], [-7.376904296874983, 55.027685546874999], [-7.451269531249977, 54.877099609375001], [-7.550390624999977, 54.76796875], [-7.886132812499994, 54.666064453124996], [-7.746289062499983, 54.615820312499999], [-7.793798828124977, 54.571240234374997], [-8.044335937499994, 54.512451171875], [-8.118261718749977, 54.414257812499997], [-7.884472656249983, 54.283789062499999], [-7.854931640624983, 54.215283203124997], [-7.678759765624989, 54.186669921875001], [-7.606542968749977, 54.143847656249996], [-7.355175781249983, 54.121240234375001], [-7.155468749999983, 54.239501953125], [-7.202587890624983, 54.301806640624996], [-7.049707031249994, 54.408251953124996], [-6.936132812499977, 54.374316406249996], [-6.7666015625, 54.195605468749996], [-6.646875, 54.163427734374999], [-6.649804687499994, 54.058642578124996], [-6.402587890625, 54.060644531249999], [-6.218017578125, 54.088720703124999]]], [[[-1.065576171874994, 50.690234375], [-1.144238281249983, 50.734716796874999], [-1.312792968749989, 50.773486328124996], [-1.515673828124989, 50.703320312499997], [-1.515332031249983, 50.669775390624999], [-1.306298828124994, 50.588525390624994], [-1.196093749999989, 50.59921875], [-1.065576171874994, 50.690234375]]]] } },
                { "type": "Feature", "properties": { "featurecla": "Admin-0 country", "scalerank": 3, "labelrank": 6, "sovereignt": "United Kingdom", "sov_a3": "GB1", "adm0_dif": 1, "level": 2, "type": "Country", "tlc": "1", "admin": "Isle of Man", "adm0_a3": "IMN", "geou_dif": 0, "geounit": "Isle of Man", "gu_a3": "IMN", "su_dif": 0, "subunit": "Isle of Man", "su_a3": "IMN", "brk_diff": 0, "name": "Isle of Man", "name_long": "Isle of Man", "brk_a3": "IMN", "brk_name": "Isle of Man", "brk_group": null, "abbrev": "IoMan", "postal": "IM", "formal_en": null, "formal_fr": null, "name_ciawf": "Isle of Man", "note_adm0": "U.K.", "note_brk": "U.K. crown dependency", "name_sort": "Isle of Man", "name_alt": null, "mapcolor7": 6, "mapcolor8": 6, "mapcolor9": 6, "mapcolor13": 3, "pop_est": 84584, "pop_rank": 8, "pop_year": 2019, "gdp_md": 7491, "gdp_year": 2018, "economy": "2. Developed region: nonG7", "income_grp": "2. High income: nonOECD", "fips_10": "IM", "iso_a2": "IM", "iso_a2_eh": "IM", "iso_a3": "IMN", "iso_a3_eh": "IMN", "iso_n3": "833", "iso_n3_eh": "833", "un_a3": "833", "wb_a2": "IM", "wb_a3": "IMY", "woe_id": 23424847, "woe_id_eh": 23424847, "woe_note": "Exact WOE match as country", "adm0_iso": "IMN", "adm0_diff": null, "adm0_tlc": "IMN", "adm0_a3_us": "IMN", "adm0_a3_fr": "IMN", "adm0_a3_ru": "IMN", "adm0_a3_es": "IMN", "adm0_a3_cn": "IMN", "adm0_a3_tw": "IMN", "adm0_a3_in": "IMN", "adm0_a3_np": "IMN", "adm0_a3_pk": "IMN", "adm0_a3_de": "IMN", "adm0_a3_gb": "IMN", "adm0_a3_br": "IMN", "adm0_a3_il": "IMN", "adm0_a3_ps": "IMN", "adm0_a3_sa": "IMN", "adm0_a3_eg": "IMN", "adm0_a3_ma": "IMN", "adm0_a3_pt": "IMN", "adm0_a3_ar": "IMN", "adm0_a3_jp": "IMN", "adm0_a3_ko": "IMN", "adm0_a3_vn": "IMN", "adm0_a3_tr": "IMN", "adm0_a3_id": "IMN", "adm0_a3_pl": "IMN", "adm0_a3_gr": "IMN", "adm0_a3_it": "IMN", "adm0_a3_nl": "IMN", "adm0_a3_se": "IMN", "adm0_a3_bd": "IMN", "adm0_a3_ua": "IMN", "adm0_a3_un": -99, "adm0_a3_wb": -99, "continent": "Europe", "region_un": "Europe", "subregion": "Northern Europe", "region_wb": "Europe & Central Asia", "name_len": 11, "long_len": 11, "abbrev_len": 5, "tiny": -99, "homepart": -99, "min_zoom": 0, "min_label": 5.0, "max_label": 10.0, "label_x": -4.530069, "label_y": 54.220833, "ne_id": 1159320721, "wikidataid": "Q9676", "name_ar": "جزيرة مان", "name_bn": "আইল অব ম্যান", "name_de": "Isle of Man", "name_en": "Isle of Man", "name_es": "Isla de Man", "name_fa": "جزیره من", "name_fr": "île de Man", "name_el": "Νήσος του Μαν", "name_he": "האי מאן", "name_hi": "आइल ऑफ़ मैन", "name_hu": "Man", "name_id": "Pulau Man", "name_it": "Isola di Man", "name_ja": "マン島", "name_ko": "맨섬", "name_nl": "Man", "name_pl": "Wyspa Man", "name_pt": "Ilha de Man", "name_ru": "остров Мэн", "name_sv": "Isle of Man", "name_tr": "Man Adası", "name_uk": "Острів Мен", "name_ur": "آئل آف مین", "name_vi": "Đảo Man", "name_zh": "马恩岛", "name_zht": "曼島", "fclass_iso": "Admin-0 country", "tlc_diff": null, "fclass_tlc": "Admin-0 country", "fclass_us": null, "fclass_fr": null, "fclass_ru": null, "fclass_es": null, "fclass_cn": null, "fclass_tw": null, "fclass_in": null, "fclass_np": null, "fclass_pk": null, "fclass_de": null, "fclass_gb": null, "fclass_br": null, "fclass_il": null, "fclass_ps": null, "fclass_sa": null, "fclass_eg": null, "fclass_ma": null, "fclass_pt": null, "fclass_ar": null, "fclass_jp": null, "fclass_ko": null, "fclass_vn": null, "fclass_tr": null, "fclass_id": null, "fclass_pl": null, "fclass_gr": null, "fclass_it": null, "fclass_nl": null, "fclass_se": null, "fclass_bd": null, "fclass_ua": null, "filename": "IMN.geojson" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[-4.412060546874983, 54.185351562499996], [-4.337988281249977, 54.269091796874996], [-4.377197265625, 54.392578125], [-4.508642578124977, 54.376708984375], [-4.614843749999977, 54.266943359374999], [-4.69873046875, 54.224902343749996], [-4.745556640624983, 54.118798828125001], [-4.6142578125, 54.058691406249999], [-4.412060546874983, 54.185351562499996]]]] } },
                { "type": "Feature", "properties": { "featurecla": null, "scalerank": -2147483644, "labelrank": null, "sovereignt": null, "sov_a3": null, "adm0_dif": null, "level": null, "type": null, "tlc": null, "admin": null, "adm0_a3": null, "geou_dif": null, "geounit": null, "gu_a3": null, "su_dif": null, "subunit": null, "su_a3": null, "brk_diff": null, "name": null, "name_long": null, "brk_a3": null, "brk_name": null, "brk_group": null, "abbrev": null, "postal": null, "formal_en": null, "formal_fr": null, "name_ciawf": null, "note_adm0": null, "note_brk": null, "name_sort": null, "name_alt": null, "mapcolor7": null, "mapcolor8": null, "mapcolor9": null, "mapcolor13": null, "pop_est": null, "pop_rank": null, "pop_year": null, "gdp_md": null, "gdp_year": null, "economy": null, "income_grp": null, "fips_10": null, "iso_a2": null, "iso_a2_eh": null, "iso_a3": null, "iso_a3_eh": null, "iso_n3": null, "iso_n3_eh": null, "un_a3": null, "wb_a2": null, "wb_a3": null, "woe_id": null, "woe_id_eh": null, "woe_note": null, "adm0_iso": null, "adm0_diff": null, "adm0_tlc": null, "adm0_a3_us": null, "adm0_a3_fr": null, "adm0_a3_ru": null, "adm0_a3_es": null, "adm0_a3_cn": null, "adm0_a3_tw": null, "adm0_a3_in": null, "adm0_a3_np": null, "adm0_a3_pk": null, "adm0_a3_de": null, "adm0_a3_gb": null, "adm0_a3_br": null, "adm0_a3_il": null, "adm0_a3_ps": null, "adm0_a3_sa": null, "adm0_a3_eg": null, "adm0_a3_ma": null, "adm0_a3_pt": null, "adm0_a3_ar": null, "adm0_a3_jp": null, "adm0_a3_ko": null, "adm0_a3_vn": null, "adm0_a3_tr": null, "adm0_a3_id": null, "adm0_a3_pl": null, "adm0_a3_gr": null, "adm0_a3_it": null, "adm0_a3_nl": null, "adm0_a3_se": null, "adm0_a3_bd": null, "adm0_a3_ua": null, "adm0_a3_un": null, "adm0_a3_wb": null, "continent": null, "region_un": null, "subregion": null, "region_wb": null, "name_len": null, "long_len": null, "abbrev_len": null, "tiny": null, "homepart": null, "min_zoom": null, "min_label": null, "max_label": null, "label_x": null, "label_y": null, "ne_id": null, "wikidataid": null, "name_ar": null, "name_bn": null, "name_de": null, "name_en": null, "name_es": null, "name_fa": null, "name_fr": null, "name_el": null, "name_he": null, "name_hi": null, "name_hu": null, "name_id": null, "name_it": null, "name_ja": null, "name_ko": null, "name_nl": null, "name_pl": null, "name_pt": null, "name_ru": null, "name_sv": null, "name_tr": null, "name_uk": null, "name_ur": null, "name_vi": null, "name_zh": null, "name_zht": null, "fclass_iso": null, "tlc_diff": null, "fclass_tlc": null, "fclass_us": null, "fclass_fr": null, "fclass_ru": null, "fclass_es": null, "fclass_cn": null, "fclass_tw": null, "fclass_in": null, "fclass_np": null, "fclass_pk": null, "fclass_de": null, "fclass_gb": null, "fclass_br": null, "fclass_il": null, "fclass_ps": null, "fclass_sa": null, "fclass_eg": null, "fclass_ma": null, "fclass_pt": null, "fclass_ar": null, "fclass_jp": null, "fclass_ko": null, "fclass_vn": null, "fclass_tr": null, "fclass_id": null, "fclass_pl": null, "fclass_gr": null, "fclass_it": null, "fclass_nl": null, "fclass_se": null, "fclass_bd": null, "fclass_ua": null, "filename": null }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[-6.365715126331868, 49.968404490670721], [-6.421126532612894, 49.897069362882334], [-6.410571979035555, 49.862212673404088], [-6.285236655304667, 49.908965884055476], [-6.22059001464347, 49.960766491669645], [-6.290513932093337, 49.990463013716351], [-6.293152570487671, 49.990463013716351], [-6.314261677642347, 49.985373482955467], [-6.314261677642347, 49.985373482955467], [-6.365715126331868, 49.968404490670721]]]] } }
            ]
        }



        mapboxgl.accessToken = 'pk.eyJ1IjoiaHVuZ3VuY2hhaW5lZCIsImEiOiJjbDFieGZyMDgwMjR3M2twMmJ1bTdlZW5wIn0.dQYKVbIDvcw65XPddVznCg';
        const map = new mapboxgl.Map({
            container: 'map',
            zoom: 5.3,
            center: { lng: -3.375524309047023, lat: 54.74094135942198 },
            style: 'mapbox://styles/mapbox/light-v11',
            projection: 'mercator'
        });

        map.on("load", () => {

            map.addSource('bbox', {
                'type': 'geojson',
                'data': {
                    'type': 'FeatureCollection',
                    'features': []
                }
            });

            map.addLayer({
                'id': 'bbox-fills',
                'type': 'fill',
                'source': 'bbox',
                'layout': {},
                'paint': {
                    'fill-color': ['get', 'color'],
                    'fill-opacity': 0.3
                }
            });


            // map.addSource('hex', {
            //     'type': 'geojson',
            //     'data': {
            //         'type': 'FeatureCollection',
            //         'features': []
            //     }
            // });

            // map.addLayer({
            //     'id': 'hex-fills',
            //     'type': 'fill',
            //     'source': 'hex',
            //     'layout': {},
            //     'paint': {
            //         'fill-color': '#627BC1',
            //         'fill-opacity': 0.6
            //     }
            // });

            // map.addLayer({
            //     'id': 'hex-borders',
            //     'type': 'line',
            //     'source': 'hex',
            //     'layout': {},
            //     'paint': {
            //         'line-color': 'white',
            //         'line-width': 2
            //     }
            // });


            map.on("click", "bbox-fills", (e) => {
                console.log(e.features[0].properties.hex);
            })

            const polygons = []

            eng1.features.forEach(f => {
                f.geometry.coordinates.map(d => {
                    console.log('d', d);
                    polygons.push(...h3.polygonToCells(d, 5, true));
                })
            })


            console.log('polygons', polygons);



            d3.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSiKJepCjhXEM3e3DF5Z2qEBdrDu9kWj5lvCflMvnXthToQ1NKdjT5TVFjg6ysiA1jFL2TaC7FiZbBL/pub?output=csv")
                .then(d => {
                    console.log('d', d);

                    const c = polygons.map(function toBoundary(hex) {
                        const geom = h3.cellToBoundary(hex, true)

                        const city = d.find(item => item.hexArray.split(",").map(e => e.trim()).includes(hex));
                        console.log('city', city);
                        const color = city ? city.colour : "gray"
                        return turf.polygon([geom], { hex, color });
                    })
                    console.log('c', c);
                    map.getSource("bbox").setData(turf.featureCollection(c))

                })
        })

    </script>

</body>

</html>